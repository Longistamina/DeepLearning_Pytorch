'''
1. Reshape: torch.reshape(tensor), tensor.reshape()
   + With vector
   + With matrix
   
2. Transpose: torch.t(tensor), tensor.t(), tensor.T
   + With 1D vector
   + With 2D vector (row vector <=> column vector)
   + With 2D matrix
   + With 3D tensor (use torch.transpose() or tensor.transpose())

3. View: tensor.view(*shape_tuple)
'''

import torch
torch.set_printoptions(precision=2)

tensor_v = torch.arange(1., 9.)
print(tensor_v)
# tensor([1., 2., 3., 4., 5., 6., 7., 8.])

torch.manual_seed(42)
tensor_M = torch.randn(4, 6)
print(tensor_M)
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66],
#         [ 0.08,  0.53,  0.35, -0.20, -1.05,  1.28],
#         [ 0.15,  0.23,  0.01, -0.14,  0.58, -0.64],
#         [-2.21, -0.75,  2.81,  0.36, -0.09,  0.46]])


#-----------------------------------------------------------------------------------------------------------#
#--------------------------------------------- 1. Reshape --------------------------------------------------#
#-----------------------------------------------------------------------------------------------------------#
'''
.reshape(shape=(n, m)): reshape to (n, m) dimension tensor
.reshape(shape=(-1, n)): set columns to n, automatically calculate the other dimension based on n columns
.reshape(shape=(n, -1)): set rows to n, automatically calculate the other dimension based on n rows
.reshape(shape=(-1, 1)): convert to column vector
.reshape(shape=(1, -1)): convert to row vector
.reshape(shape=(-1)): convert back to 1D vector
'''

#################
## With vector ##
#################

print(tensor_v)
# tensor([1., 2., 3., 4., 5., 6., 7., 8.])
'''
8 = 2x2x2
  = 4x2
  = 2x4
  = 8x1
  = 1x8
'''

print(torch.reshape(tensor_v, shape=(4, 2)))
# tensor([[1., 2.],
#         [3., 4.],
#         [5., 6.],
#         [7., 8.]])

print(torch.reshape(tensor_v, shape=(2, -1))) # Fix the number of rows = 2, automatically detect the columns
# tensor([[1., 2., 3., 4.],
#         [5., 6., 7., 8.]])

print(torch.reshape(tensor_v, shape=(1, 8)))
# tensor([[1., 2., 3., 4., 5., 6., 7., 8.]])
# Row vector

print(torch.reshape(tensor_v, shape=(-1, 1))) # Fix the number of columns = 1, automatically detect the rows
# tensor([[1.],
#         [2.],
#         [3.],
#         [4.],
#         [5.],
#         [6.],
#         [7.],
#         [8.],
# Column vector

#################
## With matrix ##
#################

print(tensor_M) # (4x6)
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66],
#         [ 0.08,  0.53,  0.35, -0.20, -1.05,  1.28],
#         [ 0.15,  0.23,  0.01, -0.14,  0.58, -0.64],
#         [-2.21, -0.75,  2.81,  0.36, -0.09,  0.46]])
'''
4x6 = 2x2x2x3
    = 6x4
    = 8x3
    = 3x8
    = 1x24
    = 24x1
'''

print(tensor_M.reshape((6, 4)))
# tensor([[ 1.31,  0.69, -1.09],
#         [-0.36, -0.91, -0.66],
#         [ 0.08,  0.53,  0.35],
#         [-0.20, -1.05,  1.28],
#         [ 0.15,  0.23,  0.01],
#         [-0.14,  0.58, -0.64],
#         [-2.21, -0.75,  2.81],
#         [ 0.36, -0.09,  0.46]])

print(tensor_M.reshape((-1, 8)))
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66,  0.08,  0.53],
#         [ 0.35, -0.20, -1.05,  1.28,  0.15,  0.23,  0.01, -0.14],
#         [ 0.58, -0.64, -2.21, -0.75,  2.81,  0.36, -0.09,  0.46]])

print(tensor_M.reshape(1, -1))
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66,  0.08,  0.53,  0.35, -0.20,
#          -1.05,  1.28,  0.15,  0.23,  0.01, -0.14,  0.58, -0.64, -2.21, -0.75,
#           2.81,  0.36, -0.09,  0.46]])
'''This is still 2D with ndim=2'''

print(tensor_M.reshape(-1))
# tensor([ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66,  0.08,  0.53,  0.35, -0.20,
#         -1.05,  1.28,  0.15,  0.23,  0.01, -0.14,  0.58, -0.64, -2.21, -0.75,
#          2.81,  0.36, -0.09,  0.46])
'''This is 1D with ndim=1'''

#-----------------------------------------------------------------------------------------------------------#
#--------------------------------------------- 2. Transpose ------------------------------------------------#
#-----------------------------------------------------------------------------------------------------------#

####################
## With 1D vector ##
####################

print(tensor_v)
# tensor([1., 2., 3., 4., 5., 6., 7., 8.])

print(torch.t(tensor_v))
# tensor([1., 2., 3., 4., 5., 6., 7., 8.])
'''Stay the same'''

####################
## With 2D vector ##
####################

print(tensor_v.reshape(-1, 1))
# tensor([[1.],
#         [2.],
#         [3.],
#         [4.],
#         [5.],
#         [6.],
#         [7.],
#         [8.]])

print(torch.t(tensor_v.reshape(-1, 1)))
# tensor([[1., 2., 3., 4., 5., 6., 7., 8.]])

print(tensor_v.reshape(-1, 1).t())
# tensor([[1., 2., 3., 4., 5., 6., 7., 8.]])

print(tensor_v.reshape(-1, 1).T)
# tensor([[1., 2., 3., 4., 5., 6., 7., 8.]])

####################
## With 2D matrix ##
####################

print(tensor_M)
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66],
#         [ 0.08,  0.53,  0.35, -0.20, -1.05,  1.28],
#         [ 0.15,  0.23,  0.01, -0.14,  0.58, -0.64],
#         [-2.21, -0.75,  2.81,  0.36, -0.09,  0.46]])

print(torch.t(tensor_M))
# tensor([[ 1.31,  0.08,  0.15, -2.21],
#         [ 0.69,  0.53,  0.23, -0.75],
#         [-1.09,  0.35,  0.01,  2.81],
#         [-0.36, -0.20, -0.14,  0.36],
#         [-0.91, -1.05,  0.58, -0.09],
#         [-0.66,  1.28, -0.64,  0.46]])

print(tensor_M.t())
# tensor([[ 1.31,  0.08,  0.15, -2.21],
#         [ 0.69,  0.53,  0.23, -0.75],
#         [-1.09,  0.35,  0.01,  2.81],
#         [-0.36, -0.20, -0.14,  0.36],
#         [-0.91, -1.05,  0.58, -0.09],
#         [-0.66,  1.28, -0.64,  0.46]])

print(tensor_M.T)
# tensor([[ 1.31,  0.08,  0.15, -2.21],
#         [ 0.69,  0.53,  0.23, -0.75],
#         [-1.09,  0.35,  0.01,  2.81],
#         [-0.36, -0.20, -0.14,  0.36],
#         [-0.91, -1.05,  0.58, -0.09],
#         [-0.66,  1.28, -0.64,  0.46]])

####################
## With 3D matrix ##
####################
'''
Use torch.transpose(tensor, dim0, dim1) or tensor.tranpose(dim0, dim1)
The given dim0 and dim1 will be swapped
'''
torch.manual_seed(0)
tensor_3D = torch.randn((3, 4, 5))
print(tensor_3D)
# tensor([[[-1.13, -1.15, -0.25, -0.43,  0.85],
#          [ 0.69, -0.32, -2.12,  0.32, -1.26],
#          [ 0.35,  0.31,  0.12,  1.24,  1.12],
#          [-0.25, -1.35, -1.70,  0.57,  0.79]],

#         [[ 0.60, -1.56, -0.34,  1.85,  0.75],
#          [-0.59, -0.17,  0.18,  1.39,  1.59],
#          [ 0.95, -0.84, -0.61,  0.03, -0.49],
#          [ 0.25,  0.44,  0.11,  0.64,  0.44]],

#         [[-0.10,  0.79, -0.29,  0.05,  0.59],
#          [ 1.54,  0.51, -0.59, -0.57,  0.92],
#          [ 1.11,  1.29, -1.50, -0.19,  0.45],
#          [ 1.33, -1.63, -0.55, -0.48, -0.50]]])

print(tensor_3D.shape)
# torch.Size([3, 4, 5])
# indices:    0  1  2

print(torch.transpose(tensor_3D, dim0=0, dim1=2))
# tensor([[[-1.13,  0.60, -0.10],
#          [ 0.69, -0.59,  1.54],
#          [ 0.35,  0.95,  1.11],
#          [-0.25,  0.25,  1.33]],

#         [[-1.15, -1.56,  0.79],
#          [-0.32, -0.17,  0.51],
#          [ 0.31, -0.84,  1.29],
#          [-1.35,  0.44, -1.63]],

#         [[-0.25, -0.34, -0.29],
#          [-2.12,  0.18, -0.59],
#          [ 0.12, -0.61, -1.50],
#          [-1.70,  0.11, -0.55]],

#         [[-0.43,  1.85,  0.05],
#          [ 0.32,  1.39, -0.57],
#          [ 1.24,  0.03, -0.19],
#          [ 0.57,  0.64, -0.48]],

#         [[ 0.85,  0.75,  0.59],
#          [-1.26,  1.59,  0.92],
#          [ 1.12, -0.49,  0.45],
#          [ 0.79,  0.44, -0.50]]])

print(torch.transpose(tensor_3D, dim0=0, dim1=2).shape)
# torch.Size([5, 4, 3])

'''
# torch.Size([3, 4, 5])
# indices:    0  1  2

dim0=0 => 3
dim1=2 => 5

After tranposing:
# torch.Size([5, 4, 3])

dim0 and dim1 are swapped
'''


#--------------------------------------------------------------------------------------------------------#
#--------------------------------------------- 3. View --------------------------------------------------#
#--------------------------------------------------------------------------------------------------------#
'''
tensor.view(*shape_tuple) works like reshape, but returns a new tensor sharing the same memory as the original.
'''

tensor_view = tensor_M.view(3, 8)
print(tensor_view)
# tensor([[ 1.31,  0.69, -1.09, -0.36, -0.91, -0.66,  0.08,  0.53],
#         [ 0.35, -0.20, -1.05,  1.28,  0.15,  0.23,  0.01, -0.14],
#         [ 0.58, -0.64, -2.21, -0.75,  2.81,  0.36, -0.09,  0.46]])